---
import NavItem from "./navigation/NavItem.astro";

const posts = await Astro.glob("../pages/**/*.md");
const nonDraftPosts = posts.filter((post) => !post.frontmatter.draft);
const unique = [...new Set(nonDraftPosts.map((item) => item.frontmatter.tag))];
const filteredLinks = unique.map((item) => ({
  tag: item,
  links: posts.filter((post) => post.frontmatter.tag === item),
}));
---

<nav class="navbar max-w-3xl mx-auto text-neutral">
  <div class="lg:flex-1">
    <a
      class="btn btn-primary normal-case text-xl"
      href="/web-course-site/"
      aria-label="На главную"
      ><svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="w-6 h-6"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"
        ></path>
      </svg>
    </a>
  </div>
  <div class="dropdown">
    <label tabindex="0" class="btn btn-primary lg:hidden">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 24 24"
        stroke-width="1.5"
        stroke="currentColor"
        class="w-6 h-6"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path>
      </svg>
    </label>
    <ul
      tabindex="0"
      class="menu menu-compact dropdown-content mt-3 p-2 shadow btn-primary rounded-box w-102"
    >
      <ul class="menu menu-horizontal p-0">
        {filteredLinks.map((data) => <NavItem tagLinks={data} />)}
      </ul>
    </ul>
  </div>

  <div class="hidden lg:flex">
    <ul class="menu menu-horizontal p-0">
      {filteredLinks.map((data) => <NavItem tagLinks={data} />)}
    </ul>
  </div>

  <a
    href="https://drive.google.com/drive/folders/1gqy63arTmR91RA67cOOXYh9U1GtcfqUA?usp=sharing"
    class="btn btn-ghost normal-case ml-auto"
    target="_blank"
    >Ведомость <svg
      xmlns="http://www.w3.org/2000/svg"
      fill="none"
      viewBox="0 0 24 24"
      stroke-width="1.5"
      stroke="currentColor"
      class="w-6 h-6"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M7.5 7.5h-.75A2.25 2.25 0 004.5 9.75v7.5a2.25 2.25 0 002.25 2.25h7.5a2.25 2.25 0 002.25-2.25v-7.5a2.25 2.25 0 00-2.25-2.25h-.75m0-3l-3-3m0 0l-3 3m3-3v11.25m6-2.25h.75a2.25 2.25 0 012.25 2.25v7.5a2.25 2.25 0 01-2.25 2.25h-7.5a2.25 2.25 0 01-2.25-2.25v-.75"
      ></path>
    </svg>
  </a>
  <button id="btndarkmode" class="btn btn-primary btn-outline">
    <svg
      fill="#000000"
      width="20px"
      height="20px"
      viewBox="0 0 35 35"
      data-name="Layer 2"
      id="Layer_2"
      xmlns="http://www.w3.org/2000/svg"
      ><path
        d="M18.44,34.68a18.22,18.22,0,0,1-2.94-.24,18.18,18.18,0,0,1-15-20.86A18.06,18.06,0,0,1,9.59.63,2.42,2.42,0,0,1,12.2.79a2.39,2.39,0,0,1,1,2.41L11.9,3.1l1.23.22A15.66,15.66,0,0,0,23.34,21h0a15.82,15.82,0,0,0,8.47.53A2.44,2.44,0,0,1,34.47,25,18.18,18.18,0,0,1,18.44,34.68ZM10.67,2.89a15.67,15.67,0,0,0-5,22.77A15.66,15.66,0,0,0,32.18,24a18.49,18.49,0,0,1-9.65-.64A18.18,18.18,0,0,1,10.67,2.89Z"
      ></path>
    </svg>
  </button>
  <script>
    function Toggle() {
      let theme = document.documentElement.getAttribute("data-theme");
      document.documentElement.setAttribute(
        "data-theme",
        theme === "halloween" ? "bumblebee" : "halloween"
      );
    }
    document.getElementById("btndarkmode").addEventListener("click", Toggle);
    Toggle();
  </script>
</nav>
